
██╗      ██████╗  ██████╗ ██╗  ██╗     ██╗
██║     ██╔═══██╗██╔════╝ ██║  ██║     ██║
██║     ██║   ██║██║  ███╗███████║     ██║
██║     ██║   ██║██║   ██║╚════██║██   ██║
███████╗╚██████╔╝╚██████╔╝     ██║╚█████╔╝
╚══════╝ ╚═════╝  ╚═════╝      ╚═╝ ╚════╝ 
                                          

CVE-2021-44228, log4j vulnerability
Hints ++ Answers at the bottom


//////////////Hints://////////////

Task 2 {Reconnaissance}
Question: What service is running on port 8983? (Just the name of the software)
{{nmap -sV -p 8983 [machine IP]}}

Task 3 {Discovery}
Question 1: Take a close look at the first page visible when navigating to http://[machine IP]:8983. You should be able 
to see clear indicators that log4j is in use within the application for logging activity. What is the -Dsolr.log.dir 
argument set to, displayed on the front page?
{{look under "args"}}

Question 2: One file has a significant number of INFO entries showing repeated requests to one specific URL endpoint. 
Which file includes contains this repeated entry? (Just the filename itself, no path needed) 
{{Hint: look for the one that has "o.a.s.s.HttpSolrCall [admin]"over and over again}}

Question 3: What "path" or URL endpoint is indicated in these repeated entries?
{{Hint:  o.a.s.s.HttpSolrCall [admin] webapp=null path=[>>>This part!<<<<]params={} status=0 QTime=0

Question 4: Viewing these log entries, what field name indicates some data entrypoint that you as a user could control? (Just the field name)
{{Hint: "Query"}}

Task 5 {Exploitation}

Question 1: What is the output of running this command? (You should leave this terminal window open as it will be actively awaiting connections)
{{Hint: "Listening on........."}}


Task 6 {Persistence}

Question 1: What user are you?
{{Hint: It'll be blank under where it says "Connection from [Machine IP:Port] Received!"
That's because this is a dumb shell. You can use python3 -c "import pty; pty.spawn('/bin/bash')" 
for a shell that is prettier.}}


Task 9 {Mitigation}

Question 1: What is the full path of the specific solr.in.sh file?
{{Hint: /etc/}}




//////////////Answers://////////////


{{Task 2}}
Question 1: Apache Solr
{{Task 3}}
Question 1: /var/solr/logs
Question 2: solr.log
Question 3: /admin/cores
Question 4: params
{{Task 5}}
Question 1: listening on 0.0.0.0:1389
{{Task 6}}
Question 1: solr
{{Task 9}}
Question 1: /etc/default/solr.in.sh
